{"remainingRequest":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xay/MovieTicketSystem/vue-admin/src/views/order/List.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xay/MovieTicketSystem/vue-admin/src/views/order/List.vue","mtime":1642510434000},{"path":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":1681457359474},{"path":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/vue-loader/lib/index.js","mtime":1681457360778}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7Q3JlYXRlT3JkZXJFeGNlcHRpb24sIEZpbmRBbGxPcmRlciwgVXBkYXRlT3JkZXJ9IGZyb20gIkAvYXBpL29yZGVyIjsKCmV4cG9ydCBkZWZhdWx0IHsKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIG9yZGVyczogW10sCiAgICAgIGZvcm06IHsKICAgICAgICBvaWQ6ICcnLAogICAgICAgIHJlYXNvbjogJycsCiAgICAgICAgcmV2aWV3ZXI6ICcnLAogICAgICB9LAogICAgfQogIH0sCgogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmxvYWRPcmRlckxpc3QoKQogIH0sCgogIG1ldGhvZHM6IHsKCiAgICBsb2FkT3JkZXJMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIEZpbmRBbGxPcmRlcigpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0aGlzLm9yZGVycyA9IHJlcy5kYXRhCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICB9LCA3MDApCiAgICAgICAgfQogICAgICB9KQogICAgfSwKCiAgICBoYW5kbGUxKGluZGV4LCBvcmRlcikgewogICAgICB0aGlzLm9yZGVyc1tpbmRleF0ub3JkZXIuc3RhdHVzID0gMwogICAgICBVcGRhdGVPcmRlcih0aGlzLm9yZGVyc1tpbmRleF0ub3JkZXIpLnRoZW4ocmVzID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpCiAgICAgICAgdGhpcy5sb2FkT3JkZXJMaXN0KCk7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICBtZXNzYWdlOiAn6K6i5Y2V5pKk6ZSA5oiQ5YqfIScKICAgICAgICB9KTsKICAgICAgfSkKICAgIH0sCgogICAgaGFuZGxlMihpbmRleCwgb3JkZXIpIHsKICAgICAgdGhpcy5mb3JtLm9pZCA9IG9yZGVyLmlkCiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlCiAgICB9LAoKICAgIHN1Ym1pdCgpIHsKICAgICAgQ3JlYXRlT3JkZXJFeGNlcHRpb24odGhpcy5mb3JtKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBtZXNzYWdlOiAn6K6i5Y2V5byC5bi45LiK5oql5oiQ5YqfIScKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgfQogICAgICB9KQogICAgfQoKICB9Cgp9Cg=="},{"version":3,"sources":["List.vue"],"names":[],"mappings":";AA4FA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"List.vue","sourceRoot":"src/views/order","sourcesContent":["<template>\n  <div class=\"main\">\n\n    <el-table\n        v-loading=\"loading\"\n        :data=\"orders\"\n        style=\"width: 100%\">\n      <el-table-column type=\"expand\">\n        <template slot-scope=\"props\">\n          <el-form label-position=\"left\" inline class=\"demo-table-expand\">\n            <el-form-item label=\"订单ID：\">\n              <span>{{ props.row.order.id }}</span>\n            </el-form-item>\n            <el-form-item label=\"用户ID：\">\n              <span>{{ props.row.user.id }}</span>\n            </el-form-item>\n            <el-form-item label=\"电影ID：\">\n              <span>{{ props.row.film.id }}</span>\n            </el-form-item>\n            <el-form-item label=\"场次ID：\">\n              <span>{{ props.row.arrangement.id }}</span>\n            </el-form-item>\n            <el-form-item label=\"电影名：\">\n              <span>《 {{ props.row.film.name }} 》</span>\n            </el-form-item>\n            <el-form-item label=\"座位号：\">\n              <span>{{ props.row.order.seats }}</span>\n            </el-form-item>\n            <el-form-item label=\"订单金额：\">\n              <span>{{ props.row.order.price }}</span>\n            </el-form-item>\n            <el-form-item label=\"下单时间：\">\n              <span>{{ props.row.order.createAt }}</span>\n            </el-form-item>\n            <el-form-item label=\"支付时间：\">\n              <span>{{ props.row.order.payAt }}</span>\n            </el-form-item>\n          </el-form>\n        </template>\n      </el-table-column>\n      <el-table-column\n          label=\"订单 ID\"\n          width=\"400\"\n          prop=\"order.id\">\n      </el-table-column>\n      <el-table-column\n          width=\"200\"\n          label=\"订单金额\"\n          prop=\"order.price\">\n      </el-table-column>\n      <el-table-column label=\"订单状态\">\n        <template slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.order.status === 2\" type=\"success\">支付成功</el-tag>\n          <el-tag v-if=\"scope.row.order.status === 0\" type=\"info\">等待支付</el-tag>\n          <el-tag v-if=\"scope.row.order.status === 3\" type=\"warning\">已被撤销</el-tag>\n          <el-tag v-if=\"scope.row.order.status === 1\" type=\"danger\">支付失败</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" width=\"250\">\n        <template slot-scope=\"scope\">\n          <el-button @click=\"handle1(scope.$index, scope.row.order)\" size=\"small\" type=\"warning\"\n                     icon=\"el-icon-refresh-right\"\n                     :disabled=\"scope.row.order.status === 3\"\n                     plain>撤销订单\n          </el-button>\n          <el-button @click=\"handle2(scope.$index, scope.row.order)\" size=\"small\" type=\"danger\"\n                     icon=\"el-icon-circle-close\"\n                     plain>上报异常\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog title=\"上报异常表单\" :visible.sync=\"dialogFormVisible\">\n      <el-form :model=\"form\" style=\"width: 400px\">\n        <el-form-item style=\"width: 100%\" label=\"上报人\" label-width=\"120px\">\n          <el-input v-model=\"form.reason\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item style=\"width: 100%\" label=\"上报原因\" label-width=\"120px\">\n          <el-input v-model=\"form.reviewer\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submit\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport {CreateOrderException, FindAllOrder, UpdateOrder} from \"@/api/order\";\n\nexport default {\n\n  data() {\n    return {\n      loading: false,\n      dialogFormVisible: false,\n      orders: [],\n      form: {\n        oid: '',\n        reason: '',\n        reviewer: '',\n      },\n    }\n  },\n\n  mounted() {\n    this.loadOrderList()\n  },\n\n  methods: {\n\n    loadOrderList() {\n      this.loading = true\n      FindAllOrder().then(res => {\n        if (res.success) {\n          setTimeout(() => {\n            this.orders = res.data\n            this.loading = false\n          }, 700)\n        }\n      })\n    },\n\n    handle1(index, order) {\n      this.orders[index].order.status = 3\n      UpdateOrder(this.orders[index].order).then(res => {\n        console.log(res)\n        this.loadOrderList();\n        this.$message({\n          type: 'success',\n          message: '订单撤销成功!'\n        });\n      })\n    },\n\n    handle2(index, order) {\n      this.form.oid = order.id\n      this.dialogFormVisible = true\n    },\n\n    submit() {\n      CreateOrderException(this.form).then(res => {\n        if (res.success) {\n          this.$message({\n            type: 'success',\n            message: '订单异常上报成功!'\n          });\n          this.dialogFormVisible = false\n        }\n      })\n    }\n\n  }\n\n}\n</script>\n\n<style scoped>\n.main {\n  padding: 30px;\n}\n\n.demo-table-expand {\n  font-size: 0;\n}\n\n.demo-table-expand label {\n  width: 90px;\n  color: #99a9bf;\n}\n\n.demo-table-expand .el-form-item {\n  margin-right: 0;\n  margin-bottom: 0;\n  width: 100%;\n}\n</style>"]}]}