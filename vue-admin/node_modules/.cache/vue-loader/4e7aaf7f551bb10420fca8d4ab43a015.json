{"remainingRequest":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xay/MovieTicketSystem/vue-admin/src/views/film/Poster.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xay/MovieTicketSystem/vue-admin/src/views/film/Poster.vue","mtime":1642510434000},{"path":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":1681457359474},{"path":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/vue-loader/lib/index.js","mtime":1681457360778}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBjb25maWcgZnJvbSAiQC9jb25maWciOwppbXBvcnQge0FkZFBvc3RlciwgRGVsZXRlQWxsUG9zdGVyLCBEZWxldGVQb3N0ZXJCeUlkLCBMaXN0QWxsUG9zdGVyLCBVcGRhdGVQb3N0ZXJ9IGZyb20gIkAvYXBpL2ZpbG0iOwoKZXhwb3J0IGRlZmF1bHQgewoKICBtb3VudGVkKCkgewogICAgTGlzdEFsbFBvc3RlcigpLnRoZW4ocmVzID0+IHsKICAgICAgdGhpcy5wb3N0ZXJMaXN0ID0gcmVzLmRhdGEKICAgIH0pCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGhlYWRlcjogewogICAgICAgICJBdXRob3JpemF0aW9uIjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIikKICAgICAgfSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICB1cGxvYWRBY3Rpb246IGNvbmZpZy5BUElfVVJMICsgJy91cGxvYWQnLAogICAgICB1cGxvYWRQb3N0ZXI6IHsKICAgICAgICB1cmw6ICcnLAogICAgICAgIHRpdGxlOiAnJywKICAgICAgICBzdGF0dXM6ICcnLAogICAgICAgIGNyZWF0ZUF0OiAnJywKICAgICAgfSwKICAgICAgcG9zdGVyTGlzdDogW10sCiAgICB9CiAgfSwKCiAgbWV0aG9kczogewoKICAgIGhhbmRsZVVwbG9hZFN1Y2Nlc3MocmVzKSB7CiAgICAgIHRoaXMudXBsb2FkUG9zdGVyLnVybCA9IHJlcwogICAgfSwKCiAgICBzdWJtaXRVcGxvYWQoKSB7CiAgICAgIEFkZFBvc3Rlcih0aGlzLnVwbG9hZFBvc3RlcikudGhlbihyZXMgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcykKICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgIH0pCiAgICB9LAoKICAgIGRlbGV0ZUFsbFBvc3RlcigpIHsKICAgICAgRGVsZXRlQWxsUG9zdGVyKCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMucG9zdGVyTGlzdCA9IG51bGw7CiAgICAgIH0pCiAgICB9LAoKICAgIGNoYW5nZVBvc3RlclN0YXR1cyhpbmRleCwgcG9zdGVyLCBzdGF0dXMpIHsKICAgICAgcG9zdGVyLnN0YXR1cyA9IHN0YXR1cwogICAgICBVcGRhdGVQb3N0ZXIocG9zdGVyKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5wb3N0ZXJMaXN0W2luZGV4XS5zdGF0dXMgPSBzdGF0dXMKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICfmiJDlip/mtojmga/vvJrmk43kvZzmiJDlip8nLAogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgfSk7CiAgICAgIH0pCiAgICB9LAoKICAgIGhhbmRsZURlbGV0ZVBvc3RlcihpbmRleCwgaWQpIHsKICAgICAgRGVsZXRlUG9zdGVyQnlJZChpZCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMucG9zdGVyTGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgbWVzc2FnZTogJ+aIkOWKn+a2iOaBr++8muWIoOmZpOaIkOWKnycsCiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICB9KTsKICAgICAgfSkKICAgIH0sCgogIH0KfQo="},{"version":3,"sources":["Poster.vue"],"names":[],"mappings":";AAuHA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Poster.vue","sourceRoot":"src/views/film","sourcesContent":["<template>\n  <div>\n    <el-carousel v-if=\"posterList.length !== 0\" height=\"500px\" indicator-position=\"outside\">\n      <el-carousel-item v-for=\"(item, index) in posterList\" :key=\"index\">\n        <img alt=\"\"\n             :src=\"item.url\"\n             class=\"image\">\n      </el-carousel-item>\n    </el-carousel>\n\n    <div class=\"content\">\n      <el-button\n          @click=\"dialogFormVisible = true\"\n          type=\"primary\"\n          icon=\"el-icon-upload\">\n        上传轮播海报\n      </el-button>\n      <el-button\n          style=\"margin-left: 10px\"\n          type=\"danger\"\n          icon=\"el-icon-delete\"\n          @click=\"deleteAllPoster\">\n        删除所有海报\n      </el-button>\n      <el-table\n          ref=\"filterTable\"\n          :data=\"posterList\"\n          style=\"width: 100%;margin-top: 15px;\">\n        <el-table-column\n            prop=\"createAt\"\n            label=\"上传时间\"\n            width=\"220\"\n        >\n        </el-table-column>\n        <el-table-column\n            prop=\"title\"\n            label=\"标题\"\n            width=\"180\">\n        </el-table-column>\n        <el-table-column label=\"地址预览\">\n          <template slot-scope=\"scope\">\n            <a target=\"_blank\" :href=\"scope.row.url\">{{ scope.row.url }}</a>\n          </template>\n        </el-table-column>\n        <el-table-column\n            prop=\"status\"\n            label=\"上架状态\"\n            width=\"220\">\n          <template slot-scope=\"scope\">\n            <el-tag\n                v-if=\"scope.row.status\"\n                type=\"success\"\n                disable-transitions>上架\n            </el-tag>\n            <el-tag\n                v-else\n                type=\"warning\"\n                disable-transitions>下架\n            </el-tag>\n            <el-button v-if=\"!scope.row.status\"\n                       style=\"padding: 0 15px;color: #67C23A\"\n                       type=\"text\"\n                       @click=\"changePosterStatus(scope.$index, scope.row, true)\"\n                       icon=\"el-icon-upload2\">上架\n            </el-button>\n            <el-button v-else\n                       style=\"padding: 0 15px;color: #E6A23C\"\n                       type=\"text\"\n                       @click=\"changePosterStatus(scope.$index, scope.row, false)\"\n                       icon=\"el-icon-download\">下架\n            </el-button>\n            <template style=\"padding-left: 100px\">\n              <el-popconfirm @confirm=\"handleDeletePoster(scope.$index, scope.row.id)\" title=\"确定要删除这条内容吗？\">\n                <el-button slot=\"reference\"\n                           style=\"color: #F56C6C\" type=\"text\"\n                           icon=\"el-icon-delete\">删除\n                </el-button>\n              </el-popconfirm>\n            </template>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n\n    <el-dialog title=\"轮播海报\" :visible.sync=\"dialogFormVisible\">\n      <el-form :model=\"uploadPoster\">\n        <el-form-item label=\"海报标题\" style=\"margin-bottom: 35px\" label-width=\"120px\">\n          <el-input style=\"width: 360px\" v-model=\"uploadPoster.title\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"上架状态\" style=\"margin-bottom: 35px\" label-width=\"120px\">\n          <el-select style=\"width: 360px\" v-model=\"uploadPoster.status\" placeholder=\"请选择活动区域\">\n            <el-option label=\"上架\" value=\"true\"></el-option>\n            <el-option label=\"下架\" value=\"false\"></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"选择图片\" label-width=\"120px\">\n          <el-upload\n              style=\"float: left\"\n              class=\"upload-demo\"\n              accept=\".png,.jpg\"\n              :headers=\"header\"\n              :action=\"uploadAction\"\n              :on-success=\"handleUploadSuccess\"\n              multiple\n              :limit=\"1\">\n            <el-button type=\"primary\" icon=\"el-icon-upload\">上传轮播海报</el-button>\n          </el-upload>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitUpload\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport config from \"@/config\";\nimport {AddPoster, DeleteAllPoster, DeletePosterById, ListAllPoster, UpdatePoster} from \"@/api/film\";\n\nexport default {\n\n  mounted() {\n    ListAllPoster().then(res => {\n      this.posterList = res.data\n    })\n  },\n\n  data() {\n    return {\n      header: {\n        \"Authorization\": localStorage.getItem(\"token\")\n      },\n      dialogFormVisible: false,\n      uploadAction: config.API_URL + '/upload',\n      uploadPoster: {\n        url: '',\n        title: '',\n        status: '',\n        createAt: '',\n      },\n      posterList: [],\n    }\n  },\n\n  methods: {\n\n    handleUploadSuccess(res) {\n      this.uploadPoster.url = res\n    },\n\n    submitUpload() {\n      AddPoster(this.uploadPoster).then(res => {\n        console.log(res)\n        this.dialogFormVisible = false;\n      })\n    },\n\n    deleteAllPoster() {\n      DeleteAllPoster().then(res => {\n        this.posterList = null;\n      })\n    },\n\n    changePosterStatus(index, poster, status) {\n      poster.status = status\n      UpdatePoster(poster).then(res => {\n        this.posterList[index].status = status\n        this.$message({\n          message: '成功消息：操作成功',\n          type: 'success'\n        });\n      })\n    },\n\n    handleDeletePoster(index, id) {\n      DeletePosterById(id).then(res => {\n        this.posterList.splice(index, 1);\n        this.$message({\n          message: '成功消息：删除成功',\n          type: 'success'\n        });\n      })\n    },\n\n  }\n}\n</script>\n\n<style scoped>\n\n.content {\n  padding: 20px 40px;\n}\n\n.el-carousel__item h3 {\n  color: #475669;\n  font-size: 18px;\n  opacity: 0.75;\n  line-height: 300px;\n  margin: 0;\n}\n\n.image {\n  width: 100%;\n  height: 500px;\n}\n\n</style>"]}]}