{"remainingRequest":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xay/MovieTicketSystem/vue-admin/src/views/order/Exception.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xay/MovieTicketSystem/vue-admin/src/views/order/Exception.vue","mtime":1642510434000},{"path":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":1681460239186},{"path":"/Users/xay/MovieTicketSystem/vue-admin/node_modules/vue-loader/lib/index.js","mtime":1681460240108}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7Q3JlYXRlT3JkZXJFeGNlcHRpb24sIEhhbmRsZU9yZGVyRXhjZXB0aW9uLCBMaXN0T3JkZXJFeGNlcHRpb24sIFVwZGF0ZU9yZGVyfSBmcm9tICJAL2FwaS9vcmRlciI7CgpleHBvcnQgZGVmYXVsdCB7CgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICBsaXN0OiBbXSwKICAgICAgZm9ybTogewogICAgICAgIHN0YXR1czogJycsCiAgICAgICAgcmVzdWx0OiAnJywKICAgICAgfSwKICAgIH0KICB9LAoKICBtb3VudGVkKCkgewogICAgdGhpcy5sb2FkTGlzdCgpCiAgfSwKCiAgbWV0aG9kczogewoKICAgIGxvYWRMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIExpc3RPcmRlckV4Y2VwdGlvbigpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0aGlzLmxpc3QgPSByZXMuZGF0YQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgfSwgNzAwKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCgogICAgaGFuZGxlKGluZGV4KSB7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlCiAgICAgIHRoaXMubGlzdFtpbmRleF0uc3RhdHVzID0gdGhpcy5mb3JtLnN0YXR1cwogICAgICB0aGlzLmxpc3RbaW5kZXhdLnJlc3VsdCA9IHRoaXMuZm9ybS5yZXN1bHQKICAgICAgdGhpcy5mb3JtID0gdGhpcy5saXN0W2luZGV4XQogICAgfSwKCiAgICBzdWJtaXQoKSB7CiAgICAgIEhhbmRsZU9yZGVyRXhjZXB0aW9uKHRoaXMuZm9ybSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgbWVzc2FnZTogJ+iuouWNleWkhOeQhuaIkOWKnyEnCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgICAgICAgdGhpcy5sb2FkTGlzdCgpCiAgICAgICAgfQogICAgICB9KQogICAgfQoKICB9Cgp9Cg=="},{"version":3,"sources":["Exception.vue"],"names":[],"mappings":";AAqFA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"Exception.vue","sourceRoot":"src/views/order","sourcesContent":["<template>\n  <div class=\"main\">\n\n    <el-table\n        v-loading=\"loading\"\n        :data=\"list\"\n        style=\"width: 100%\">\n      <el-table-column type=\"expand\">\n        <template slot-scope=\"props\">\n          <el-form label-position=\"left\" inline class=\"demo-table-expand\">\n            <el-form-item label=\"ID：\">\n              <span>{{ props.row.id }}</span>\n            </el-form-item>\n            <el-form-item label=\"订单ID：\">\n              <span>{{ props.row.oid }}</span>\n            </el-form-item>\n            <el-form-item label=\"异常原因：\">\n              <span>{{ props.row.reason }}</span>\n            </el-form-item>\n            <el-form-item label=\"上报人：\">\n              <span>{{ props.row.reviewer }}</span>\n            </el-form-item>\n            <el-form-item label=\"是否已处理完成：\">\n              <span>{{ props.row.status }}</span>\n            </el-form-item>\n            <el-form-item label=\"处理结果：\">\n              <span>{{ props.row.result }}</span>\n            </el-form-item>\n            <el-form-item label=\"上报时间：\">\n              <span>{{ props.row.createAt }}</span>\n            </el-form-item>\n            <el-form-item label=\"处理时间：\">\n              <span>{{ props.row.endAt }}</span>\n            </el-form-item>\n          </el-form>\n        </template>\n      </el-table-column>\n      <el-table-column\n          label=\"订单 ID\"\n          width=\"400\"\n          prop=\"oid\">\n      </el-table-column>\n      <el-table-column\n          width=\"200\"\n          label=\"上报人\"\n          prop=\"reviewer\">\n      </el-table-column>\n      <el-table-column label=\"异常处理状态\">\n        <template slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.status\" type=\"success\">处理成功</el-tag>\n          <el-tag v-if=\"!scope.row.status\" type=\"danger\">等待处理</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\">\n        <template slot-scope=\"scope\">\n          <el-button @click=\"handle(scope.$index)\" size=\"small\" type=\"primary\"\n                     icon=\"el-icon-s-check\"\n                     plain>处理异常\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog title=\"异常处理结果表单\" :visible.sync=\"dialogFormVisible\">\n      <el-form :model=\"form\" style=\"width: 400px\">\n        <el-form-item label=\"处理结果\" label-width=\"120px\">\n          <el-input v-model=\"form.result\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"活动区域\" label-width=\"120px\">\n          <el-select v-model=\"form.status\" placeholder=\"请选择处理状态\">\n            <el-option label=\"处理完成\" value=\"true\"></el-option>\n            <el-option label=\"还未完成\" value=\"false\"></el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submit\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport {CreateOrderException, HandleOrderException, ListOrderException, UpdateOrder} from \"@/api/order\";\n\nexport default {\n\n  data() {\n    return {\n      loading: false,\n      dialogFormVisible: false,\n      list: [],\n      form: {\n        status: '',\n        result: '',\n      },\n    }\n  },\n\n  mounted() {\n    this.loadList()\n  },\n\n  methods: {\n\n    loadList() {\n      this.loading = true\n      ListOrderException().then(res => {\n        if (res.success) {\n          setTimeout(() => {\n            this.list = res.data\n            this.loading = false\n          }, 700)\n        }\n      })\n    },\n\n    handle(index) {\n      this.dialogFormVisible = true\n      this.list[index].status = this.form.status\n      this.list[index].result = this.form.result\n      this.form = this.list[index]\n    },\n\n    submit() {\n      HandleOrderException(this.form).then(res => {\n        if (res.success) {\n          this.$message({\n            type: 'success',\n            message: '订单处理成功!'\n          });\n          this.dialogFormVisible = false\n          this.loadList()\n        }\n      })\n    }\n\n  }\n\n}\n</script>\n\n<style scoped>\n.main {\n  padding: 30px;\n}\n\n.demo-table-expand {\n  font-size: 0;\n}\n\n.demo-table-expand label {\n  width: 90px;\n  color: #99a9bf;\n}\n\n.demo-table-expand .el-form-item {\n  margin-right: 0;\n  margin-bottom: 0;\n  width: 100%;\n}\n</style>"]}]}